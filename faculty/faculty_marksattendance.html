<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marks & Attendance</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: white;
            --text-color: black;
            --header-bg: white;
            --header-text: black;
            --button-bg: lightgray;
            --button-text: black;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: var(--header-bg);
            color: var(--header-text);
            border-bottom: 1px solid #ccc;
        }

        header .logo {
            display: flex;
            align-items: center;
        }

        header .logo img {
            margin-right: 10px;
        }

        header .navbar a {
            margin: 0 10px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: 500;
        }

        header .navbar a.active {
            text-decoration: underline;
        }

        button {
            padding: 10px 15px;
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            opacity: 0.9;
        }

        .container {
            padding: 20px;
            max-width: 800px;
            margin: auto;
        }

        .student-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 5px;
        }

        .student-row span {
            flex-grow: 1;
            text-align: center;
        }

        .subject-buttons {
            display: flex;
            gap: 10px;
        }

        .subject-buttons button {
            padding: 5px 10px;
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }

        .subject-buttons button.present {
            background-color: green;
            color: white;
        }

        .subject-buttons button.absent {
            background-color: red;
            color: white;
        }

        .attendance-record {
            padding: 10px;
            border-top: 1px solid #ddd;
            margin-top: 10px;
            font-size: 14px;
            color: #555;
        }

        .attendance-record span {
            display: block;
        }

        .dark-mode {
            --bg-color: black;
            --text-color: white;
            --header-bg: #333;
            --header-text: white;
            --button-bg: gray;
            --button-text: white;
        }

        .attendance-table {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
        }

        .attendance-table th, .attendance-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        .attendance-table th {
            background-color: #f4f4f4;
        }

        .attendance-table .present {
            background-color: green;
            color: white;
        }

        .attendance-table .absent {
            background-color: red;
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <img src="src/cit.png" alt="CIT Logo" style="width: 40px; height: 40px;">
            <h2>Faculty Bridge</h2>
        </div>
        <div class="navbar">
            <a href="faculty.html" class="active">Home</a>
            <a href="faculty_post_announcements.html">Post Announcements</a>
            <a href="faculty_add_update_marks.html">Add/Update Marks</a>
            <a href="faculty_marksattendance.html">Marks & Attendance</a>
            <a href="faculty_view_students.html">View Students</a>
            <a href="timetable.html">Time Table</a>
            <a href="../index.html">Logout</a>
        </div>
        <button id="theme-toggle">Switch to Dark Mode</button>
    </header>

    <div class="container">
        <h2>Dynamic Attendance Management</h2>
        <div id="attendance-container">
            <!-- Student rows will be generated dynamically -->
        </div>
        <div id="attendance-records">
            <!-- Attendance records will be displayed here -->
            <table class="attendance-table">
                <thead>
                    <tr>
                        <th>Student ID</th>
                        <th>Java</th>
                        <th>DSA</th>
                        <th>OS</th>
                        <th>Math</th>
                        <th>DBMS</th>
                    </tr>
                </thead>
                <tbody id="attendance-table-body">
                    <!-- Attendance records rows will be dynamically added here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const themeToggle = document.getElementById("theme-toggle");

        themeToggle.addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            themeToggle.textContent = document.body.classList.contains("dark-mode")
                ? "Switch to Light Mode"
                : "Switch to Dark Mode";
        });

        const attendanceContainer = document.getElementById('attendance-container');
        const attendanceTableBody = document.getElementById('attendance-table-body');

        // Array to store attendance records
        let attendanceRecordsArray = [];

        // Function to generate student rows
        function generateStudentRows() {
            const students = Array.from({ length: 10 }, (_, index) => ({
                id: `24037176622${index + 1}`,
                name: `Student ${index + 1}`
            }));

            attendanceContainer.innerHTML = students.map(student => `
                <div class="student-row">
                    <span>${student.name}</span>
                    <div class="subject-buttons" data-student-id="${student.id}">
                        <button onclick="markAttendance('${student.id}', 'Java')">Java</button>
                        <button onclick="markAttendance('${student.id}', 'DSA')">DSA</button>
                        <button onclick="markAttendance('${student.id}', 'OS')">OS</button>
                        <button onclick="markAttendance('${student.id}', 'Math')">Math</button>
                        <button onclick="markAttendance('${student.id}', 'DBMS')">DBMS</button>
                    </div>
                </div>
            `).join('');
        }

        // Function to mark attendance
        function markAttendance(studentId, subject) {
            const studentRow = document.querySelector(`.subject-buttons[data-student-id="${studentId}"]`);
            const subjectButton = studentRow.querySelector(`button[onclick*="${subject}"]`);
            const recordIndex = attendanceRecordsArray.findIndex(record => record.studentId === studentId && record.subject === subject);

            if (recordIndex !== -1) {
                // Update existing record
                attendanceRecordsArray[recordIndex].status = 'present';
            } else {
                // Add new record
                attendanceRecordsArray.push({ studentId, subject, status: 'present' });
            }

            // Toggle button classes
            subjectButton.classList.add('present');
            subjectButton.classList.remove('absent');

            // Update attendance records display
            updateAttendanceRecords();
        }

        // Function to update attendance records display
        function updateAttendanceRecords() {
            const recordsMap = attendanceRecordsArray.reduce((acc, record) => {
                if (!acc[record.studentId]) {
                    acc[record.studentId] = {};
                }
                acc[record.studentId][record.subject] = record.status;
                return acc;
            }, {});

            attendanceTableBody.innerHTML = Object.entries(recordsMap).map(([studentId, subjects]) => `
                <tr>
                    <td>${studentId}</td>
                    <td class="${subjects.Java === 'present' ? 'present' : 'absent'}">${subjects.Java || 'absent'}</td>
                    <td class="${subjects.DSA === 'present' ? 'present' : 'absent'}">${subjects.DSA || 'absent'}</td>
                    <td class="${subjects.OS === 'present' ? 'present' : 'absent'}">${subjects.OS || 'absent'}</td>
                    <td class="${subjects.Math === 'present' ? 'present' : 'absent'}">${subjects.Math || 'absent'}</td>
                    <td class="${subjects.DBMS === 'present' ? 'present' : 'absent'}">${subjects.DBMS || 'absent'}</td>
                </tr>
            `).join('');
        }

        // Initialize student rows
        generateStudentRows();
    </script>
</body>
</html>
